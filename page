<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.14: http://docutils.sourceforge.net/" />
<title>mysql用户与权限</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="mysql">
<h1 class="title">mysql用户与权限</h1>

<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#id1" id="id8">1&nbsp;&nbsp;&nbsp;MySQL权限</a><ul class="auto-toc">
<li><a class="reference internal" href="#id2" id="id9">1.1&nbsp;&nbsp;&nbsp;mysql权限表</a></li>
<li><a class="reference internal" href="#id3" id="id10">1.2&nbsp;&nbsp;&nbsp;mysql权限详解</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4" id="id11">2&nbsp;&nbsp;&nbsp;MySQL用户</a><ul class="auto-toc">
<li><a class="reference internal" href="#id5" id="id12">2.1&nbsp;&nbsp;&nbsp;授予权限与添加用户</a></li>
<li><a class="reference internal" href="#id6" id="id13">2.2&nbsp;&nbsp;&nbsp;取消权限与删除用户</a></li>
<li><a class="reference internal" href="#id7" id="id14">2.3&nbsp;&nbsp;&nbsp;修改密码</a></li>
</ul>
</li>
</ul>
</div>
<p>mysql内置了一个系统数据库mysql,其中包含存放着权限系统所需要的数据的授权表</p>
<p>mysql数据库中用于权限的授权表主要包括user,db,host,tables_priv,column_priv</p>
<div class="section" id="id1">
<h1><a class="toc-backref" href="#id8">1&nbsp;&nbsp;&nbsp;MySQL权限</a></h1>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id9">1.1&nbsp;&nbsp;&nbsp;mysql权限表</a></h2>
<p>mysql数据库中的3个权限表: user,db,host</p>
<p>权限表的存取过程(两个阶段):</p>
<blockquote>
<ol class="arabic simple">
<li>连接核实: 先从user表中的host, user, password这3个字段中判断连接的IP,用户名,密码是否存在表中, 存在则通过身份验证;</li>
<li>请求核实: 通过权限验证, 进行权限分配时, 按照 user --&gt; db --&gt; tables_priv --&gt; columns_priv 的顺序进行分配. 即先检查全局权限表 user, 如果user中对应的权限为Y, 则此用户对所有数据库的权限都为Y, 将不再检查db,tables_priv,columns_priv; 如果为N, 则到db表中检查此用户对应的具体数据库, 并得到db中为Y的权限; 如果db中为N, 则检查tables_priv中此数据库对应的具体表, 取得表中的权限Y, 以此类推.</li>
</ol>
</blockquote>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id10">1.2&nbsp;&nbsp;&nbsp;mysql权限详解</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<tbody valign="top">
<tr><td>权限</td>
<td>意义</td>
</tr>
<tr><td>ALL [PRIVILEGES]</td>
<td>设置除了GRANT OPTION以外的所有权限</td>
</tr>
<tr><td>ALTER</td>
<td>允许使用ALTER TABLE</td>
</tr>
<tr><td>ALTER ROUTINE</td>
<td>更改或取消已存储的子程序</td>
</tr>
<tr><td>CREATE</td>
<td>允许使用CREATE TABLE</td>
</tr>
<tr><td>CREATE ROUTINE</td>
<td>创建已存储的子程序</td>
</tr>
<tr><td>CREATE TEMPORARY TABLES</td>
<td>允许使用CREATE TEMPORARY TABLE</td>
</tr>
<tr><td>CREATE USER</td>
<td>允许使用CREATE USER, DROP USER,RENAME USER,REVOKE ALL PRIVILEGES</td>
</tr>
<tr><td>CREATE VIEW</td>
<td>允许所使用CREATE VIEW</td>
</tr>
<tr><td>DELETE</td>
<td>允许使用DELETE</td>
</tr>
<tr><td>DROP</td>
<td>允许使用DROP TABLE</td>
</tr>
<tr><td>EXECUTE</td>
<td>允许用户运行已存储的子程序</td>
</tr>
<tr><td>FILE</td>
<td>允许使用SELECT...INTO OUTFILE和LOAD DATA INFILE</td>
</tr>
<tr><td>INDEX</td>
<td>允许使用CREATE INDEX 和DROP INDEX</td>
</tr>
<tr><td>INSERT</td>
<td>允许使用INSERT</td>
</tr>
<tr><td>LOCK TABLE</td>
<td>允许对拥有SELECT权限的表使用LOCK TABLES</td>
</tr>
<tr><td>PROCESS</td>
<td>允许使用SHOW FULL PROCESSLIST</td>
</tr>
<tr><td>REFERENCES</td>
<td>未被实施</td>
</tr>
<tr><td>RELOAD</td>
<td>允许使用FLUSH</td>
</tr>
<tr><td>REPLICATION CLIENT</td>
<td>允许用户询问从属服务器或者主服务器的地址</td>
</tr>
<tr><td>REPLICATION SLAVE</td>
<td>用于复制型从属服务器, 从主服务器中读取二进制日志事件</td>
</tr>
<tr><td>SELECT</td>
<td>允许使用SELECT</td>
</tr>
<tr><td>SHOW DATABASES</td>
<td>SHOW DATABASES显示所有数据库</td>
</tr>
<tr><td>SHOW VIEW</td>
<td>允许使用SHOW CREATE VIEW</td>
</tr>
<tr><td>SHOW SHUTDOWN</td>
<td>允许使用mysqladmin shutdown</td>
</tr>
<tr><td>SUPER</td>
<td>允许使用CHANGE MASTER, KILL,Purge MASTER LOGS 和SET GLOBAL语句</td>
</tr>
<tr><td>UPDATE</td>
<td>允许使用UPDATE</td>
</tr>
<tr><td>USAGE</td>
<td>&quot;无权限的&quot;同义词! 该权限只能用于数据库登陆, 不能执行任何操作;
且usage权限不能被回收, 也即REVOKE用户并不能删除用户.</td>
</tr>
<tr><td>GRANT OPTION</td>
<td>允许授予权限</td>
</tr>
</tbody>
</table>
<p>(以下操作都是以root身份登陆进行grant授权, 以kade&#64;localhost身份登陆执行各种命令.)</p>
<ol class="arabic">
<li><p class="first">usage</p>
<blockquote>
<p>连接(登陆)权限, 建立一个用户, 就会自动授予其usage权限(默认授予).</p>
<pre class="literal-block">
mysql&gt; grant usage on *.* to 'kade'&#64;'localhost' identified by '123';
</pre>
<p>该权限只能用于数据库登陆, 不能执行任何操作; 且usage权限不能被回收, 也即REVOKE用户并不能删除用户.</p>
</blockquote>
</li>
<li><p class="first">select</p>
<blockquote>
<p>必须有select的权限, 才可以使用select table</p>
<pre class="literal-block">
mysql&gt; grant select on pyt.* to 'kade'&#64;'localhost';
mysql&gt; select * from shop;
</pre>
</blockquote>
</li>
<li><p class="first">create</p>
<blockquote>
<p>必须有create的权限, 才可以使用create table</p>
<pre class="literal-block">
mysql&gt; grant create on pyt.* to 'kade'&#64;'localhost';
</pre>
</blockquote>
</li>
<li><p class="first">create routine</p>
<blockquote>
<p>必须具有create routine的权限, 才可以使用{create|alter|drop} {procedure|function}</p>
<pre class="literal-block">
mysql&gt; grant create routine on pyt.* to 'kade'&#64;'localhost';
当授予create routine时, 自动授予EXECUTE, ALTER ROUTINE权限给它的创建者:
mysql&gt; show grants for 'kade'&#64;'localhost';
+—————————————————————————+
Grants for kade&#64;localhost
+————————————————————————–+
| GRANT USAGE ON *.* TO 'kade'&#64;'localhost' IDENTIFIED BY PASSWORD '*23AE809DDACAF96AF0FD78ED04B6A265E05AA257' |
| GRANT SELECT, CREATE, CREATE ROUTINE ON `pyt`.* TO 'kade'&#64;'localhost'|
| GRANT EXECUTE, ALTER ROUTINE ON PROCEDURE `pyt`.`pro_shokade` TO 'kade'&#64;'localhost' |
+————————————————————————————-+
</pre>
</blockquote>
</li>
<li><p class="first">create temporary tables(注意这里是tables, 不是table)</p>
<blockquote>
<p>必须有create temporary tables的权限, 才可以使用create temporary tables.</p>
<pre class="literal-block">
mysql&gt; grant create temporary tables on pyt.* to 'kade'&#64;'localhost';
[mysql&#64;kade-x200s ~]$ mysql -h localhost -u kade -p pyt
mysql&gt; create temporary table tt1(id int);
</pre>
</blockquote>
</li>
<li><p class="first">create view</p>
<blockquote>
<p>必须有create view的权限, 才可以使用create view:</p>
<pre class="literal-block">
mysql&gt; grant create view on pyt.* to 'kade'&#64;'localhost';
mysql&gt; create view v_shop as select price from shop;
</pre>
</blockquote>
</li>
<li><p class="first">create user</p>
<blockquote>
<p>要使用CREATE USER, 必须拥有mysql数据库的全局CREATE USER权限, 或拥有INSERT权限.</p>
<pre class="literal-block">
mysql&gt; grant create user on *.* to 'kade'&#64;'localhost';
或: mysql&gt; grant insert on *.* to kade&#64;localhost;
</pre>
</blockquote>
</li>
<li><p class="first">insert</p>
<blockquote>
<p>必须有insert的权限, 才可以使用insert into .... values ...</p>
</blockquote>
</li>
<li><p class="first">alter</p>
<blockquote>
<p>必须有alter的权限, 才可以使用alter table</p>
<pre class="literal-block">
alter table shop modify dealer char(15);
</pre>
</blockquote>
</li>
<li><p class="first">alter routine</p>
<blockquote>
<p>必须具有alter routine的权限, 才可以使用{alter|drop} {procedure|function}</p>
<pre class="literal-block">
mysql&gt; grant alter routine on pyt.* to 'kade'&#64;'localhost';
mysql&gt; drop procedure pro_shop;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; revoke alter routine on pyt.* from 'kade'&#64;'localhost';
[mysql&#64;kade-x200s ~]$ mysql -h localhost -u kade -p pyt
mysql&gt; drop procedure pro_shop;
ERROR 1370 (42000): alter routine command denied to user 'kade'&#64;'localhost' for routine 'pyt.pro_shop'
</pre>
</blockquote>
</li>
<li><p class="first">update</p>
<blockquote>
<p>必须有update的权限, 才可以使用update table</p>
<pre class="literal-block">
mysql&gt; update shop set price=3.5 where article=0001 and dealer='A';
</pre>
</blockquote>
</li>
<li><p class="first">delete</p>
<blockquote>
<p>必须有delete的权限, 才可以使用delete from ... where ... (删除表中的记录)</p>
</blockquote>
</li>
<li><p class="first">drop</p>
<blockquote>
<p>必须有drop的权限, 才可以使用drop database db_name; drop table tab_name; drop view vi_name; drop index in_name;</p>
</blockquote>
</li>
<li><p class="first">show databases</p>
<blockquote>
<p>通过show databases只能看到你拥有的某些权限的数据库, 除非你拥有全局SHOW DATABASES权限.
对于kade&#64;localhost用户来说, 没有对mysql数据库的权限, 所以以此身份登陆查询时, 无法看到mysql数据库:</p>
<pre class="literal-block">
mysql&gt; show databases;
+——————–+
| Database |
+——————–+
| information_schema|
| pyt |
| test |
+——————–+
</pre>
</blockquote>
</li>
<li><p class="first">show view</p>
<blockquote>
<p>必须拥有show view权限, 才能执行show create view.</p>
<pre class="literal-block">
mysql&gt; grant show view on pyt.* to kade&#64;localhost
</pre>
</blockquote>
</li>
</ol>
</div>
</div>
<div class="section" id="id4">
<h1><a class="toc-backref" href="#id11">2&nbsp;&nbsp;&nbsp;MySQL用户</a></h1>
<p>当用户登录到数据库里面, 可以设定不同的用户对于数据库的权限, 比如给予select和insert权限, 限定哪个ip可以访问数据库, 并且设置密码等.</p>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id12">2.1&nbsp;&nbsp;&nbsp;授予权限与添加用户</a></h2>
<p>增加mysql数据库用户: 通过使用GRANT语句或通过直接操作mysql授权表.</p>
<p>一般使用GRANT语句, 更简明并且能降低错误的发生.</p>
<p>下面的例子显示出如何使用mysql客户安装新用户. 这些例子假定权限根据以前的章节描述的缺省被安装. 这意味着为了改变, 你必须在mysqld正在运行同一台机器上, 你必须作为mysql root用户连接, 并且root用户必须对mysql数据库有insert权限和reload管理权限. 另外, 如果你改变了root用户口令, 你必须如下的mysql命令指定它.</p>
<p>GRANT语句增加新用户:</p>
<pre class="literal-block">
 shell&gt; mysql --user=root mysql

 mysql&gt; GRANT ALL PRIVILEGES ON *.* TO kade&#64;localhost
              IDENTIFIED BY 'something' WITH GRANT OPTION;

 mysql&gt; GRANT ALL PRIVILEGES ON *.* TO kade&#64;&quot;%&quot;       &lt;----如果匹配中文, 用两个%
              IDENTIFIED BY 'something' WITH GRANT OPTION;

 mysql&gt; GRANT RELOAD,PROCESS ON *.* TO admin&#64;localhost;

 mysql&gt; GRANT USAGE ON *.* TO uplooking&#64;localhost;


说明::

     ALL PRIVILEGES:  表示所有权限

     ON:  指定这些权限应用于哪些表和库

     *.*:  表示所有库和表

     TO:  表示这些权限给哪个用户, 用户跟在TO的后面

     kade&#64;localhost:  kade是用户名, &#64;符号后面确定了只允许该用户通过localhost这台主机来访问, 可以跟IP地址
     如: kade&#64;192.168.1.221

     INENTIFIED BY: 表示设定用户密码, 密码用单引号

     WITH GRANT OPTION: 允许指定用户把他所用哟的权限再付给其它用户.
</pre>
<p>上面的GRANT语句添加了3个新用户:</p>
<ul class="simple">
<li>kade</li>
</ul>
<p>可以从任何地方连接服务器的一个完全的超级用户, 但是必须使用一个口令'something'来登录.</p>
<p>注意, 我们必须对kade&#64;localhost和kade&#64;&quot;%&quot;发出GRANT语句, 如果我们增加localhost条目, 对localhost的匿名用户条目在我们从本地主机连接接时由mysql_install_db创建的条目将优先考虑, 因为它有更特定的Host字段值, 所以以user表排列顺序看更早到来.</p>
<ul class="simple">
<li>admin</li>
</ul>
<p>可以从localhost不使用口令进行连接并且被授予reload和process管理权限的用户.
这允许用户执行mysqladmin reload,mysqladmin refresh和mysqladmin flush-*命令,
还有mysqladmin processlist.
没有授予数据库有关的权限. 可以在以后通过发出另一个GRANT语句授权.</p>
<ul class="simple">
<li>uplooking</li>
</ul>
<p>可以不用一个口令连接的一个用户, 但是只能从本地主机. 全局权限被设置为'N'--USAGE权限类型允许你无需权限就可设置一个用户. 它假定你将在以后授予数据库相关的权限.</p>
<p><em>PS.</em></p>
<p>with_option:</p>
<ul class="simple">
<li>GRANT OPTION：允许用户再将该权限授予其它用户；</li>
<li>MAX_QUERIES_PER_HOUR：允许用户每小时执行的查询语句数量；</li>
<li>MAX_UPDATES_PER_HOUR：允许用户每小时执行的更新语句数量；</li>
<li>MAX_CONNECTIONS_PER_HOUR：允许用户每小时连接的次数；</li>
<li>MAX_USER_CONNECTIONS：允许用户同时连接服务器的数量</li>
</ul>

<p>GRANT语句:</p>
<pre class="literal-block">
shell&gt; mysql --user=root mysql

mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
             ON bankaccount.*
             TO custom&#64;localhost
           IDENTIFIED BY 'stupid';

mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
           ON expenses.*
           TO custom&#64;uplooking.com
           IDENTIFIED BY 'stupid';

mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
       ON customer.*
       TO custom&#64;'%'
       IDENTIFIED BY 'stupid';
</pre>
<p>如果你想要给特定的用户从一个给定的域上的任何机器上存取权限, 你可以发出一个如下的GRANT语句:</p>
<pre class="literal-block">
mysql&gt; GRANT ...
          ON *.*
          TO myusername&#64;&quot;%.mydomainname.com&quot;
          IDENTIFIED BY 'mypassword';
</pre>
<p>你也可以使用mysqladmin,mysql_webadmin等工具在授权表中插入,改变和更新值.</p>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id13">2.2&nbsp;&nbsp;&nbsp;取消权限与删除用户</a></h2>
<pre class="literal-block">
shell&gt; drop user kade&#64;localhost;

注意: 用执行DROP USER, 你必须拥有mysql数据库的全局CREATE USER权限或者DELETE权限, 否则无法删除!
</pre>
<p>作为数据库的管理员, 既然能够创建用户和授权, 同样也可以取消授权和删除用户. 要取消某个用户的权限, 可以使用REVOKE语句.</p>
<p>该语句的语法格式如下:</p>
<pre class="literal-block">
mysql&gt; REVOKE PRIVILEGES (columns) on what from user ;
</pre>
<p>其中PRIVILEGES是要取消的权限, user是要被取消权限的用户名.</p>
<p>示例: 下面的代码实现了取消sss用户的所有权限的功能.</p>
<pre class="literal-block">
mysql&gt; revoke all on *.* from sss&#64;localhost ;
Query OK, 0 rows affected (0.00 sec)

注意: REVOKE语句只能取消用户的权限, 而不可以删除用户. 即使取消了所有的权限, 用户仍然可以连接到服务器.
</pre>
<p>如果想要彻底地删除用户, 必须使用DELETE语句将该用户的记录从mysql数据库中的user表中删除. 该语句的语法格式如下:</p>
<pre class="literal-block">
shell&gt; DELETE FROM user where user = &quot;user_name&quot; and host = &quot;host_name&quot; ;
</pre>
<p>使用DELETE删除用户sss, 代码如下:</p>
<pre class="literal-block">
mysql&gt; use mysql
Database changed

mysql&gt; delete from user where user='sss' and host='localhost' ;

mysql&gt;flush privileges ;
Query OK, 1 row affected (0.02 sec)
</pre>
<p>其中, delete用于删除用户, flush告诉服务器重新加载授权表. 实验看下如果没有执行flush privileges的效果.</p>
</div>
<div class="section" id="id7">
<h2><a class="toc-backref" href="#id14">2.3&nbsp;&nbsp;&nbsp;修改密码</a></h2>
<ol class="arabic">
<li><p class="first">mysqladmin:</p>
<pre class="literal-block">
mysqladmin -uroot -p password 'newpw'
</pre>
</li>
<li><p class="first">grant语句</p>
</li>
</ol>
<p>我们可以用grant语句来实现修改用户密码的目的, 同时, 我们也可以用update user表中的字段来实现.</p>
<pre class="literal-block">
mysql&gt; GRANT useage on *.* kade&#64;localhost identified by '654321';
或
mysql&gt; update user set password=password('654321') where user=&quot;kade&quot;;

mysql&gt;flush privileges ;
Query OK, 1 row affected (0.02 sec)
</pre>
<ol class="arabic simple" start="3">
<li>修改root用户密码</li>
</ol>
<p>一般情况下, 如果你忘记了普通用户的密码, 那么直接通过上面的方法就可以达到修改密码的目的, 但是如果是root密码, 用上述方法将无法完成.</p>
<p>如果真的忘记密码了, 可以用如下的方法完成:</p>
<ul>
<li><p class="first">首先停止运行mysqld这个服务:</p>
<pre class="literal-block">
shell&gt; service mysqld stop
或
shell&gt; killall -TERM mysqld
或
shell&gt; pkill mysqld
</pre>
</li>
<li><p class="first">然后以安全模式进入启动mysql:</p>
<pre class="literal-block">
shell&gt; mysqld_safe --skip-grant-tables &amp;

shell&gt; mysql

mysql&gt; use mysql;
mysql&gt; update user set password=password('654321') where user='root';
mysql&gt; exit

shell&gt; service mysqld restart

注意: 以安全模式启动mysql后, 任何用户都可以root用户登录, 并且不需要密码, 所以要保证在网络环境中, 尽可能快地完成上述操作, 以保证相对的安全!
</pre>
</li>
</ul>
</div>
</div>
</div>
</body>
</html>
